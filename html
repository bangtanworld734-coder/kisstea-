<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Happy Birthday Kisstea ‚ú®</title>

<!-- Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Quicksand:wght@300;400;600&display=swap" rel="stylesheet">

<style>
  :root{
    --bg-1: #050509;
    --bg-2: #0b0f16;
    --bg-3: #121826;
    --glow: rgba(154,120,255,0.28);
    --accent: #cdbaff;
    --text: #f2eaff;
    --card: #141226;
  }

  /* Reset + base */
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0;
    font-family:"Quicksand", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    background: linear-gradient(180deg, var(--bg-1), var(--bg-2), var(--bg-3));
    color:var(--text);
    overflow-x:hidden;
    -webkit-font-smoothing:antialiased;
    -moz-osx-font-smoothing:grayscale;
    text-align:center;
  }

  /* Loading screen (custom) */
  #loader{
    position:fixed;inset:0;
    display:flex;align-items:center;justify-content:center;flex-direction:column;
    background:linear-gradient(180deg,#030308,#05050a);
    z-index:9999;color:var(--accent);
  }
  .loader-moon{
    width:80px;height:80px;border-radius:50%;
    background:radial-gradient(circle,#fff,#e6d4ff,#7e58ff);
    box-shadow:0 0 40px rgba(140,110,255,0.9);
    animation:loaderPulse 1800ms infinite ease-in-out;
  }
  @keyframes loaderPulse{0%{transform:scale(1)}50%{transform:scale(1.14)}100%{transform:scale(1)}}

  /* layout header */
  header{margin:26px 16px 8px}
  .title{font-family:"Playfair Display",serif;font-size:2.6rem; color:#decfff; margin:0}
  .subtitle{color:#bba3ff;margin-top:6px;font-size:0.95rem}

  /* floating moon */
  .floating-moon{
    position:fixed;right:36px;top:36px;width:110px;height:110px;border-radius:50%;
    background:radial-gradient(circle,#f7f3ff,#d0b8ff,#8666ff);
    box-shadow:0 8px 40px rgba(140,110,255,0.55);
    animation:floatMoon 6000ms ease-in-out infinite;
    z-index:5;
    transition: transform .3s ease, right .3s ease, top .3s ease;
  }
  @keyframes floatMoon{0%{transform:translateY(0)}50%{transform:translateY(-16px)}100%{transform:translateY(0)}}

  /* hero image */
  .hero{width:100%;max-width:980px;margin:14px auto;border-radius:14px;overflow:hidden;box-shadow:0 0 44px var(--glow);height:320px}
  .hero img{width:100%;height:100%;object-fit:cover;display:block;filter:brightness(.65);transition:transform 10s linear}
  .hero:hover img{transform:scale(1.03)}

  /* buttons */
  .controls{display:flex;gap:12px;justify-content:center;flex-wrap:wrap;margin-top:14px}
  .btn{background:linear-gradient(180deg,#221a3a,#2f234f);color:var(--text);padding:10px 18px;border-radius:999px;border:1px solid rgba(120,90,255,0.12);cursor:pointer;font-weight:600;box-shadow:0 6px 18px rgba(100,70,200,0.14)}
  .btn:active{transform:translateY(1px)}
  .btn.small{padding:8px 12px;font-size:0.95rem}

  /* letter */
  .letter{max-width:760px;margin:26px auto;background:linear-gradient(180deg,#12101e,#141226);padding:20px;border-radius:12px;box-shadow:0 10px 36px rgba(90,70,200,0.12);color:#efe6ff;opacity:0;transform:translateY(8px);transition:opacity .6s ease, transform .6s ease}
  .letter.show{opacity:1;transform:none}

  /* gallery */
  h2.section-title{margin-top:40px;margin-bottom:10px;color:#e8dcff;font-weight:600;font-size:1.1rem}
  .gallery{max-width:980px;margin:0 auto;padding:16px;display:grid;grid-template-columns:repeat(auto-fit,minmax(160px,1fr));gap:14px;align-items:start}
  .gallery .pic{background:linear-gradient(180deg,#0f0d18,#151325);border-radius:12px;padding:8px;cursor:pointer;transition:transform .35s ease, box-shadow .35s ease}
  .gallery img{width:100%;height:180px;object-fit:cover;border-radius:8px;display:block}
  .gallery .pic:active{transform:translateY(4px)}
  .gallery .pic:hover{transform:scale(1.03);box-shadow:0 14px 40px rgba(120,80,255,0.12)}

  /* lightbox */
  .lightbox{position:fixed;inset:0;background:rgba(6,6,12,0.85);display:flex;align-items:center;justify-content:center;z-index:9998;padding:20px;visibility:hidden;opacity:0;transition:opacity .3s ease, visibility .3s}
  .lightbox.show{visibility:visible;opacity:1}
  .lightbox img{max-width:92%;max-height:86%;border-radius:10px;box-shadow:0 30px 80px rgba(0,0,0,0.6)}

  /* game */
  .game-box{max-width:760px;margin:36px auto 80px;padding:18px;border-radius:12px;background:linear-gradient(180deg,#121018,#10101a);box-shadow:0 8px 30px rgba(100,70,220,0.06)}
  #cake{font-size:3.8rem;margin:10px 0}
  .game-note{color:#d7caff;font-size:0.95rem;margin-top:8px}

  /* petal + particles containers */
  .petal-container{position:fixed;inset:0;pointer-events:none;overflow:hidden;z-index:1}
  .petal{position:absolute;top:-12px;width:16px;height:16px;background:radial-gradient(circle,#d9a4ff,#9b5bff);border-radius:70% 30% 70% 30%;opacity:0.95;animation:fall linear forwards}
  @keyframes fall{0%{transform:translateY(0) rotate(0deg)}100%{transform:translateY(115vh) rotate(360deg)}}

  .star{position:fixed;width:3px;height:3px;border-radius:50%;background:rgba(255,255,255,0.9);box-shadow:0 0 8px rgba(255,255,255,0.6);animation:twinkle 3s infinite;pointer-events:none}
  @keyframes twinkle{0%{opacity:.18}50%{opacity:1}100%{opacity:.28}}

  /* fade-in helper for better mobile animation */
  .fade-in{opacity:0;transform:translateY(8px);transition:opacity .7s ease, transform .7s ease}
  .fade-in.show{opacity:1;transform:none}

  /* responsive & mobile improvements */
  @media (max-width:700px){
    .floating-moon{right:50%;transform:translateX(50%);top:18px;width:82px;height:82px}
    .hero{height:220px}
    .gallery img{height:140px}
    .title{font-size:1.7rem}
    .controls{padding:0 10px}
    .petal{width:12px;height:12px}
  }

  /* respect reduced motion */
  @media (prefers-reduced-motion: reduce){
    .hero img{transition:none}
    .floating-moon, .loader-moon, .petal, .star, .firefly{animation:none}
  }
</style>
</head>
<body>

<!-- Loading screen -->
<div id="loader">
  <div class="loader-moon" aria-hidden="true"></div>
  <div style="margin-top:12px;color:var(--accent)">loading your night meadow‚Ä¶</div>
</div>

<!-- floating moon -->
<div class="floating-moon" aria-hidden="true"></div>

<header>
  <h1 class="title">happy birthday, kisstea ‚ú®</h1>
  <div class="subtitle">a dreamy night meadow just for you</div>
</header>

<!-- hero -->
<div class="hero fade-in" id="heroEl"><img src="images/hero.jpg" alt="kisstea in the meadow"></div>

<!-- controls -->
<div class="controls fade-in" id="controlsEl">
  <button class="btn" id="openLetterBtn">Open your birthday note üíå</button>
  <button class="btn" id="playToggleBtn">Play music üé∂</button>
  <button class="btn" id="viewGalleryBtn">View gallery üì∏</button>
</div>

<!-- letter -->
<section class="letter fade-in" id="letterEl" aria-hidden="true">
  <p style="margin:0;font-size:1rem;line-height:1.6;color:#f3e9ff">
    happy birthday kisstea! being roommates for those few months is gonna shine bright in my memories.
    here's to more adventures w you. i miss you and shillong trip toh karke hi rahenge.
  </p>
</section>

<!-- Memory gallery -->
<h2 class="section-title fade-in" id="galleryTitle">üì∏ Memory Gallery</h2>
<div class="gallery fade-in" id="galleryEl">
  <!-- Replace these with your images (pic1..pic6 etc) -->
  <div class="pic"><img src="images/pic1.jpg" alt="memory 1"></div>
  <div class="pic"><img src="images/pic2.jpg" alt="memory 2"></div>
  <div class="pic"><img src="images/pic3.jpg" alt="memory 3"></div>
  <div class="pic"><img src="images/pic4.jpg" alt="memory 4"></div>
  <div class="pic"><img src="images/pic5.jpg" alt="memory 5"></div>
  <div class="pic"><img src="images/pic6.jpg" alt="memory 6"></div>
</div>

<!-- lightbox -->
<div class="lightbox" id="lightbox" role="dialog" aria-modal="true" aria-hidden="true">
  <img src="" alt="expanded memory" id="lightboxImg">
</div>

<!-- cake mini-game -->
<section class="game-box fade-in" id="gameEl">
  <h3 style="margin:8px 0 4px">üéÇ Birthday Cake</h3>
  <div id="cake">üç∞</div>
  <div class="game-note">Tap the cake 5 times for a tiny surprise!</div>
  <div style="margin-top:12px"><button class="btn small" id="cakeBtn">Tap üç∞</button></div>
  <p id="cakeMsg" style="margin-top:12px;color:#e7ddff;font-weight:600"></p>
</section>

<!-- decorative containers -->
<div class="petal-container" id="petalContainer" aria-hidden="true"></div>
<!-- stars & fireflies will be added via JS -->

<!-- audio element (local mp3 preferred). If not present, script will try fallback. -->
<audio id="bgAudio" src="salvatore.mp3" loop preload="auto"></audio>

<script>
/* ---------- Utilities & progressive enhancements ---------- */

/* Fade in main elements after load (better mobile animation) */
function revealEls() {
  ['heroEl','controlsEl','letterEl','galleryEl','galleryTitle','gameEl'].forEach(id => {
    const el = document.getElementById(id);
    if(!el) return;
    // add small stagger
    setTimeout(()=> el.classList && el.classList.add('show'), 250 + Math.random()*350);
  });
  // also explicitly show letter as hidden until clicked (keeps a smooth effect)
  document.getElementById('letterEl').classList.remove('show'); // keep hidden
}

/* Loader handling */
window.addEventListener('load', ()=> {
  const loader = document.getElementById('loader');
  // small delay so user can appreciate loader
  setTimeout(()=> {
    loader.style.transition = 'opacity .45s ease';
    loader.style.opacity = 0;
    setTimeout(()=> loader.remove(), 500);
    revealEls();
  }, 650);
});

/* ---------- Floating stars (twinkling) ---------- */
function createStars(count){
  // reduce on small screens
  const isSmall = window.matchMedia('(max-width:700px)').matches;
  const n = isSmall ? Math.max(6, Math.floor(count/3)) : count;
  for(let i=0;i<n;i++){
    const s = document.createElement('div');
    s.className = 'star';
    s.style.left = (Math.random()*100) + 'vw';
    s.style.top = (Math.random()*80) + 'vh';
    s.style.opacity = 0.2 + Math.random()*0.9;
    s.style.animationDelay = (Math.random()*3) + 's';
    s.style.transform = `scale(${0.6 + Math.random()*1.4})`;
    document.body.appendChild(s);
  }
}
createStars(28);

/* ---------- Fireflies (glowing insects drifting) ---------- */
function createFireflies(count){
  const isSmall = window.matchMedia('(max-width:700px)').matches;
  const n = isSmall ? Math.max(6, Math.floor(count/3)) : count;
  for(let i=0;i<n;i++){
    const f = document.createElement('div');
    f.className = 'star'; // reuse star style but smaller glow via shadow
    f.style.width = '6px'; f.style.height = '6px';
    f.style.boxShadow = '0 0 10px 6px rgba(255,235,170,0.6)';
    f.style.left = (Math.random()*100) + 'vw';
    f.style.top = (Math.random()*80) + 'vh';
    f.style.animationDelay = (Math.random()*4)+'s';
    // random float animation using CSS keyframes via inline animation
    const dur = 6000 + Math.random()*8000;
    f.style.animation = `drift ${dur}ms ease-in-out ${(Math.random()*2000)}ms infinite`;
    f.style.borderRadius = '50%';
    // create keyframes dynamically (scoped per element)
    const dx = (Math.random()*160 - 80), dy = (Math.random()*-120);
    const kname = 'drift_' + i;
    const styleSheet = document.styleSheets[0];
    try {
      styleSheet.insertRule(`
        @keyframes ${kname}{
          0% { transform: translate(0,0) scale(1); opacity: .85; }
          50% { transform: translate(${dx}px, ${dy}px) scale(1.4); opacity: 1; }
          100% { transform: translate(${dx/2}px, ${dy/2}px) scale(1); opacity: .7; }
        }
      `, styleSheet.cssRules.length);
      f.style.animationName = kname;
    } catch(e){}
    document.body.appendChild(f);
  }
}
createFireflies(18);

/* ---------- Petals (falling) ---------- */
const petalContainer = document.getElementById('petalContainer');
function spawnPetal(){
  const isSmall = window.matchMedia('(max-width:700px)').matches;
  // fewer & slower on mobile
  const dur = isSmall ? 6000 + Math.random()*5000 : 4000 + Math.random()*5000;
  const p = document.createElement('div');
  p.className = 'petal';
  p.style.left = (Math.random()*100) + 'vw';
  p.style.animationDuration = dur + 'ms';
  p.style.opacity = (0.6 + Math.random()*0.4);
  petalContainer.appendChild(p);
  setTimeout(()=> p.remove(), dur + 600);
}
// spawn at a rate that is smaller on mobile
const petalInterval = window.matchMedia('(max-width:700px)').matches ? 700 : 420;
setInterval(spawnPetal, petalInterval);

/* ---------- Responsive moon reposition on small screens ---------- */
function adjustMoon(){
  const moon = document.querySelector('.floating-moon');
  if(!moon) return;
  if(window.matchMedia('(max-width:700px)').matches){
    moon.style.right = '50%';
    moon.style.transform = 'translateX(50%)';
    moon.style.top = '14px';
  } else {
    moon.style.right = '36px';
    moon.style.transform = '';
    moon.style.top = '36px';
  }
}
window.addEventListener('resize', adjustMoon);
adjustMoon();

/* ---------- Reveal toggles & interactions ---------- */
const openLetterBtn = document.getElementById('openLetterBtn');
const letterEl = document.getElementById('letterEl');
openLetterBtn.addEventListener('click', ()=>{
  const shown = letterEl.classList.toggle('show');
  // scroll into view when opening
  if(shown) letterEl.scrollIntoView({behavior:'smooth', block:'center'});
});

/* ---------- Gallery lightbox (mobile-friendly) ---------- */
const gallery = document.getElementById('galleryEl');
const lightbox = document.getElementById('lightbox');
const lightboxImg = document.getElementById('lightboxImg');
gallery.addEventListener('click', (e)=>{
  const pic = e.target.closest('.pic');
  if(!pic) return;
  const img = pic.querySelector('img');
  if(!img) return;
  lightboxImg.src = img.src;
  lightbox.classList.add('show');
  lightbox.setAttribute('aria-hidden','false');
});
// close lightbox on click
lightbox.addEventListener('click', ()=> {
  lightbox.classList.remove('show');
  lightbox.setAttribute('aria-hidden','true');
  setTimeout(()=> lightboxImg.src = '', 250);
});

/* ---------- Cake mini-game ---------- */
let taps=0;
const cakeBtn = document.getElementById('cakeBtn');
const cakeMsg = document.getElementById('cakeMsg');
cakeBtn.addEventListener('click', ()=>{
  taps++;
  cakeMsg.textContent = `Taps: ${taps}/5`;
  if(taps >= 5){
    cakeMsg.textContent = '‚ú® cake unlocked ‚Äî sending you cosmic hugs, kisstea!';
    // little celebration animation (temporary)
    const c = document.getElementById('cake');
    c.style.transform = 'scale(1.18)';
    setTimeout(()=> c.style.transform = '', 350);
    taps = 0; // reset so they can play again
  }
});

/* ---------- Audio autoplay with fallback ---------- */
const audio = document.getElementById('bgAudio');
const playToggleBtn = document.getElementById('playToggleBtn');
let usingYTFallback = false;
async function tryPlayAudio(){
  if(!audio) return false;
  try {
    await audio.play();
    playToggleBtn.textContent = 'Pause music ‚è∏Ô∏è';
    return true;
  } catch(err){
    // autoplay blocked ‚Äî try a small visible user gesture approach: change button text and prepare fallback
    playToggleBtn.textContent = 'Play music üé∂';
    return false;
  }
}
tryPlayAudio();

// if user clicks playToggleBtn, toggle audio or fallback to YT iframe if no local file available
let ytIframe = null;
playToggleBtn.addEventListener('click', async ()=>{
  if(usingYTFallback){
    // stop YT
    if(ytIframe){ ytIframe.remove(); ytIframe = null; usingYTFallback = false; playToggleBtn.textContent = 'Play music üé∂'; }
    return;
  }
  if(audio && audio.paused){
    // attempt to play
    try {
      await audio.play();
      playToggleBtn.textContent = 'Pause music ‚è∏Ô∏è';
      usingYTFallback = false;
    } catch(e){
      // fallback: create small hidden YouTube iframe with autoplay
      ytIframe = document.createElement('iframe');
      ytIframe.width = 1; ytIframe.height = 1; ytIframe.style.visibility = 'hidden';
      // Video id used: cI0wUoCLnLk (Salvatore). If region/disallowed, consider replacing or removing.
      ytIframe.src = 'https://www.youtube.com/embed/cI0wUoCLnLk?autoplay=1&mute=0&loop=1&playlist=cI0wUoCLnLk';
      ytIframe.allow = 'autoplay; encrypted-media';
      document.body.appendChild(ytIframe);
      usingYTFallback = true;
      playToggleBtn.textContent = 'Stop music ‚è∏Ô∏è';
    }
  } else if(audio && !audio.paused){
    audio.pause();
    playToggleBtn.textContent = 'Play music üé∂';
  } else {
    // nothing available: attempt YT fallback
    ytIframe = document.createElement('iframe');
    ytIframe.width = 1; ytIframe.height = 1; ytIframe.style.visibility = 'hidden';
    ytIframe.src = 'https://www.youtube.com/embed/cI0wUoCLnLk?autoplay=1&mute=0&loop=1&playlist=cI0wUoCLnLk';
    ytIframe.allow = 'autoplay; encrypted-media';
    document.body.appendChild(ytIframe);
    usingYTFallback = true;
    playToggleBtn.textContent = 'Stop music ‚è∏Ô∏è';
  }
});

/* ---------- Accessibility: reduce heavy animations on touch devices ---------- */
if(('ontouchstart' in window) || navigator.maxTouchPoints > 0){
  // slow down heavy intervals a bit on touch devices
  // already respected via media queries, but can keep additional tuning if needed
}

/* Respect reduced motion preference already handled in CSS */

</script>
</body>
</html>
